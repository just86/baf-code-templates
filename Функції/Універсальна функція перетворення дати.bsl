// <function_purpose>Назначение: Преобразование текстовой даты в любом формате в объект Дата</function_purpose>
// <parameters>Параметры: ТекстДаты – Строка – Текст с датой в формате "dd.MM.yyyy HH:mm:ss" или "dd/MM/yyyy HH:mm:ss"</parameters>
// <returns>Возвращаемое: Дата – Преобразованная дата или Неопределено при ошибке</returns>
// <notes>Примечания: Поддерживает форматы с разделителями: ".", "/", "-"</notes>
// <examples>Пример: Дата = ПреобразоватьТекстВДату("23/09/2025 09:06:00")</examples>
//
Функция ПреобразоватьТекстВДату(ТекстДаты)
	
	// <check_empty>
	Если Не ЗначениеЗаполнено(ТекстДаты) Тогда
		
		Возврат Неопределено;
		
	КонецЕсли;
	// </check_empty>
	
	// <check_if_already_date>
	Если ТипЗнч(ТекстДаты) = Тип("Дата") Тогда
		
		Возврат ТекстДаты;
		
	КонецЕсли;
	// </check_if_already_date>
	
	// <normalize_string>
	// Заменяем все разделители на точки
	ТекстНормализованный = СтрЗаменить(СтрЗаменить(ТекстДаты, "/", "."), "-", ".");
	// </normalize_string>
	
	// <try_parse>
	Попытка
		
		// Пробуем преобразовать стандартным способом
		РезультатДата = Дата(ТекстНормализованный);
		Возврат РезультатДата;
		
	Исключение
		
		// Если не получилось, пробуем разобрать вручную
		Попытка
			
			// Удаляем все разделители
			СтрокаБезРазделителей = СтрЗаменить(СтрЗаменить(СтрЗаменить(СтрЗаменить(ТекстНормализованный, ".", ""), " ", ""), ":", ""), "-", "");
			
			// Извлекаем компоненты даты
			Если СтрДлина(СтрокаБезРазделителей) >= 8 Тогда
				
				День = Сред(СтрокаБезРазделителей, 1, 2);
				Месяц = Сред(СтрокаБезРазделителей, 3, 2);
				Год = Сред(СтрокаБезРазделителей, 5, 4);
				
				// Время (если есть)
				Если СтрДлина(СтрокаБезРазделителей) >= 14 Тогда
					
					Часы = Сред(СтрокаБезРазделителей, 9, 2);
					Минуты = Сред(СтрокаБезРазделителей, 11, 2);
					Секунды = Сред(СтрокаБезРазделителей, 13, 2);
					
					РезультатДата = Дата(Год + Месяц + День + Часы + Минуты + Секунды);
					
				Иначе
					
					РезультатДата = Дата(Год + Месяц + День);
					
				КонецЕсли;
				
				Возврат РезультатДата;
				
			КонецЕсли;
			
		Исключение
			
			// Ничего не вышло
			Возврат Неопределено;
			
		КонецПопытки;
		
	КонецПопытки;
	// </try_parse>
	
	Возврат Неопределено;
	
КонецФункции